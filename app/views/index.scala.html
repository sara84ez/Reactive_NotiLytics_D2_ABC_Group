@()
@main("Live Stream") {
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<div class="container mt-4 text-light bg-dark p-4 rounded">
    <h1 class="mb-4">Live News Stream</h1>

    <div class="input-group mb-3">
        <input id="query" type="text" class="form-control" placeholder="Search...">
        <button id="sendBtn" class="btn btn-primary">Search</button>
    </div>

    <div id="results" class="row"></div>
</div>

<script>
let socket = new WebSocket("ws://" + window.location.host + "/ws");

document.getElementById("sendBtn").onclick = () => {
    let q = document.getElementById("query").value;
    socket.send(JSON.stringify({ type: "search", query: q }));
};

socket.onmessage = (event) => {
    let msg = JSON.parse(event.data);
    if (msg.articles) appendArticles(msg.articles);
};

function appendArticles(list) {
    let container = document.getElementById("results");
    list.forEach(a => {
        container.innerHTML += `
        <div class='col-md-4'>
            <div class='card bg-secondary text-white mb-3'>
                <div class='card-body'>
                    <h5 class='card-title'>${a.title}</h5>
                    <p>${a.description}</p>
                    <a href='${a.url}' target='_blank' class='btn btn-outline-light'>Read more</a>
                </div>
            </div>
        </div>`;
    });
}
</script>
}
